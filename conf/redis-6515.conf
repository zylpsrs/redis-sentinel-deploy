# run as a daemon
daemonize yes

# Pidfile
pidfile "/oss/redis/tmp/redis-6515.pid"

# The listen Port, Default is *:6515
#bind 127.0.0.1
port 6515

# no default, so Redis will not listen on a unix socket when not specified.
#unixsocket /tmp/redis.sock
#unixsocketperm 755

# Close the connection after a client is idle for N seconds (0 to disable)
timeout 0

# TCP keepalive.
#
# If non-zero(in seconds), use SO_KEEPALIVE to send TCP ACKs to clients in
# absence of communication. This is useful for two reasons:
#
# 1) Detect dead peers.
# 2) Take the connection alive from the point of view of network
#    equipment in the middle.
tcp-keepalive 0

# Log
loglevel warning
logfile "/oss/redis/log/redis-6515.log"

# Syslog
#syslog-enabled no
#syslog-ident redis
#syslog-facility local0

# Set the number of databases.
databases 16

# defrag
activedefrag yes

################### SNAPSHOTTING ######################
# Save the DB on disk:
save 900 1
save 300 10
save 60 10000

# Redis will Not stop accepting writes if RDB snapshots are enabled
# (at least one save point) and the latest background save failed.
stop-writes-on-bgsave-error no

# Compress RDB
rdbcompression yes

# RDB created with checksum
rdbchecksum yes

# The filename where to dump the DB
dbfilename "redis-6515-dump.rdb"

# The working directory.
dir "/oss/redis/data"

################### REPLICATION ######################
# Master-Slave replication
#slaveof <masterip> <masterport>

# When a slave loses its connection with the master, or when the replication
# is still in progress, the slave can act in two different ways:
#
#   - 'yes': slave will still reply to client requests;
#   - 'no' : the slave will reply with an error "SYNC with master in progress"
#
replica-serve-stale-data yes

# configure slave instance to accept writes or not
replica-read-only yes

# timeout for both Bulk transfer I/O timeout and
# master data or ping response timeout.
repl-timeout 300

# Disable TCP_NODELAY on the slave socket after SYNC?
repl-disable-tcp-nodelay no

# slave priority
replica-priority 100

################### LIMITS ########################
#maxclients 10000
#maxmemory <bytes>
#maxmemory-policy volatile-lru

################### APPEND ONLY MODE ####################
appendonly no
appendfilename "redis-6515-ady.aof"
appendfsync everysec
no-appendfsync-on-rewrite no

# Automatic rewrite of the append only file.
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb

#################### LUA SCRIPTING #####################
# Max execution time of a Lua script in milliseconds.
lua-time-limit 5000

#################### SLOW LOG ##########################
slowlog-log-slower-than 10000
slowlog-max-len 128

#################### SECURITY ##########################
protected-mode yes
masterauth "Change1me"
requirepass "Change1me"

############## ADVANCED CONFIG #########################
# hashes and lists
hash-max-ziplist-entries 512
hash-max-ziplist-value 64
list-max-ziplist-entries 512
list-max-ziplist-value 64
set-max-intset-entries 512
zset-max-ziplist-entries 128
zset-max-ziplist-value 64
activerehashing yes

# client output buffer limits
client-output-buffer-limit normal 0 0 0
client-output-buffer-limit replica 0 0 0
client-output-buffer-limit pubsub 32mb 8mb 60

hz 10
aof-rewrite-incremental-fsync yes
# Generated by CONFIG REWRITE
